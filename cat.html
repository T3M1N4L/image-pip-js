<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cat</title>
    <link rel="icon" type="image/x-icon" href="https://raw.githubusercontent.com/T3M1N4L/T3M1N4L/refs/heads/main/cat.png">
    <style>
      body {
        background-color: #000;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        flex-direction: column;
        text-align: center;
      }

      button {
        border-color: #5bfcb9;
        color: black;
        background-color: #0b0b14;
        box-shadow: 0 0 50px 50px #5bfcb9 inset, 0 0 0 0 #5bfcb9;
        transition: all 150ms ease-in-out;
        border: none;
        border-radius: 10px;
        height: 80px;
        width: 200px;
        font-weight: 700;
        font-size: 16px;
        border-radius: 20px;
        margin: 10px;
      }

      button:hover {
        box-shadow: 0 0 10px 0 #5bfcb9 inset, 0 0 10px 4px #5bfcb9;
        border: none;
        color: white;
        border-radius: 10px;
        -moz-transition: all 0.3s;
        -webkit-transition: all 0.3s;
        transition: all 0.3s;
        filter: drop-shadow(0 0 0.75rem #5bfcb9);
      }

      #video-pip-btn {
        border-color: #983dff !important;
        box-shadow: 0 0 50px 50px #983dff inset, 0 0 0 0 #983dff !important;
      }

      #video-pip-btn:hover {
        box-shadow: 0 0 10px 0 #983dff inset, 0 0 10px 4px #983dff !important;
        filter: drop-shadow(0 0 0.75rem #983dff) !important;
      }

      .pip-container {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        background-color: transparent;
        box-sizing: border-box;
      }

      img {
        border-radius: 20px;
        margin-bottom: 20px;
      }

      #button-container {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 20px;
      }
    </style>
  </head>
  <body>
    <img src="https://raw.githubusercontent.com/T3M1N4L/T3M1N4L/refs/heads/main/cat.png" alt="Cat" width="30%">
    <div id="button-container">
      <button id="video-pip-btn">Video-Style PiP</button>
      <button id="html-pip-btn">HTML Element PiP</button>
    </div>
    <div id="html-pip-content" class="pip-container" style="display: none;">
      <img src="https://raw.githubusercontent.com/T3M1N4L/T3M1N4L/refs/heads/main/cat.png" alt="Cat" width="100%">
    </div>
    <canvas id="canvas" width="400" height="400" style="display:none;"></canvas>
    <script>
      const videoPipBtn = document.getElementById('video-pip-btn');
      const htmlPipBtn = document.getElementById('html-pip-btn');
      const htmlPipContent = document.getElementById('html-pip-content');
      const canvas = document.getElementById('canvas');
      const ctx = canvas.getContext('2d');
      let videoElement = null;
      let htmlPipWindow = null;
      let pipActive = false;

      function drawImageOnCanvas() {
        const image = new Image();
        image.src = "https://raw.githubusercontent.com/T3M1N4L/T3M1N4L/refs/heads/main/cat.png";
        image.crossOrigin = "anonymous";
        image.onload = () => {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          ctx.drawImage(image, 0, 0, canvas.width, canvas.height);
        };
      }
      async function enterVideoPiP() {
        if (!videoElement) {
          videoElement = document.createElement('video');
          const stream = canvas.captureStream();
          videoElement.srcObject = stream;
          videoElement.muted = true;
          videoElement.playsInline = true;
          videoElement.onloadedmetadata = () => videoElement.play();
          videoElement.onenterpictureinpicture = () => pipActive = true;
          videoElement.onleavepictureinpicture = () => pipActive = false;
        }
        try {
          if (!document.pictureInPictureElement) {
            await drawImageOnCanvas();
            await videoElement.requestPictureInPicture();
          } else {
            await document.exitPictureInPicture();
          }
        } catch (error) {
          console.error("Error with video PiP:", error);
        }
      }
      async function enterHtmlPiP() {
        try {
          const pipOptions = {
            initialAspectRatio: 1,
            lockAspectRatio: false,
          };
          htmlPipWindow = await documentPictureInPicture.requestWindow(pipOptions);
          htmlPipContent.style.display = "flex";
          htmlPipWindow.document.body.style.margin = "0";
          htmlPipWindow.document.body.style.padding = "0";
          htmlPipWindow.document.body.style.backgroundColor = "transparent";
          htmlPipWindow.document.body.style.overflow = "hidden";
          htmlPipWindow.document.body.append(htmlPipContent);
          htmlPipWindow.addEventListener("unload", () => {
            document.body.append(htmlPipContent);
            htmlPipContent.style.display = "none";
            htmlPipWindow = null;
          }, {
            once: true
          });
        } catch (error) {
          console.error("Error with HTML PiP:", error);
        }
      }
      videoPipBtn.addEventListener('click', () => enterVideoPiP());
      htmlPipBtn.addEventListener('click', () => enterHtmlPiP());
    </script>
  </body>
</html>